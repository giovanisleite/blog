---
slug: "push-sub-tree"
title: "TWIL #2 - Monorepo e deploys separados - Descobrindo o git submodule"
date: "2021-07-15"
description: "Uso do git subtree (Photo by Zach Reiner on Unsplash - https://unsplash.com/photos/H7LxvEmVZnE)"
tags:
  - git
banner: "branch.webp"
---

Estava fazendo uma aplica√ß√£o, testando umas paradas, em um monorepo. A raiz do projeto com duas pastas, uma com o front, React, e outra com o backend, Rails. Tudo beleza localmente, da√≠ chega a hora do deploy. Estou acostumado a usar o Heroku para o backend e o Netlify para o frontend, segui com esses. Da√≠ veio o sofrimento, como fazer o Heroku rodar uma aplica√ß√£o Rails que n√£o est√° na pasta raiz?

A melhor solu√ß√£o veio com ele, o git!

O git tem uma feature para facilitar a manuten√ß√£o de m√∫ltiplos reposit√≥rios em um s√≥, [git subtree](https://www.atlassian.com/git/tutorials/git-subtree). Assim, voc√™ pode organizar os reposit√≥rios remotos de forma que voc√™ fa√ßa o push de apenas uma das pastas por exemplo para um reposit√≥rio. E como isso se encaixa na solu√ß√£o do nosso problema?

Quando voc√™ est√° com uma aplica√ß√£o no heroku, voc√™ pode adicion√°-lo como um reposit√≥rio remoto al√©m do default (origin). Assim, sempre que voc√™ fizer um push para esse outro reposit√≥rio vai acontecer um deploy no Heroku. Assim, utilizando o comando `git subtree push --prefix api/ heroku master` eu consegui mandar para o Heroku apenas a pasta da API sem precisar configurar nada, al√©m do padr√£o, para que ele rodasse a aplica√ß√£o Rails, visto que ele estava esperando que a aplica√ß√£o fosse a raiz do projeto. Dessa forma ele s√≥ tem acesso ao backend e roda tranquilamente üéâ

E esse √© o segundo This Week I Learned (TWIL) üòä

Para saber mais:

- [Guia introdut√≥rio](https://gist.github.com/SKempin/b7857a6ff6bddb05717cc17a44091202)
- [Tutorial feito pela Atlassian](https://www.atlassian.com/git/tutorials/git-subtree)
